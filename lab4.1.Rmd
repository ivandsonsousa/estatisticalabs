---
title: 'Lab4.1: A Distribuição Normal'
date: "2023-02-25"
output:
  rmdformats::readthedown
  # html_document:
  # number_sections: no
  #   toc: yes
  #   toc_float: yes
  #   theme: cerulean
  #   df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
```


## Introdução


Neste laboratório, investigaremos a distribuição de probabilidade mais importante para a estatística: a distribuição normal. Se estivermos confiantes de que nossos dados são quase normais, isso abre a porta para muitos métodos estatísticos poderosos. Aqui, usaremos as ferramentas gráficas do R para avaliar a normalidade de nossos dados e também aprenderemos como gerar números aleatórios a partir de uma distribuição normal.


```{r}
library(ggplot2)
library(plyr)
library(tidyr)
library(dplyr)
library(DescTools)
library(htmltools)
library(knitr)
library(rmarkdown)
library(combinat)
library(kableExtra) #Para gerar tabelas com um layout agradável
```


## Conteúdos abordados neste laboratório


* Distribuição normal
* quantis
* Distribuição normal padrão


## Os dados

Neste laboratório, trabalharemos com medidas de dimensões corporais. Este conjunto de dados contém medições de 247 homens e 260 mulheres, a maioria dos quais considerados adultos jovens saudáveis.


```{r}
download.file("http://www.openintro.org/stat/data/bdims.RData", destfile = "bdims.RData")
load("bdims.RData")
```


Vamos dar uma olhada rápida nas primeiras linhas dos dados:


```{r}
head(bdims) %>%
  kable() %>%
  kable_styling(
    full_width = F, 
    bootstrap_options = c("striped", "hover", "condensed",
                          "responsive")
    )
```



Você verá que para cada observação temos 25 medidas, muitas das quais são diâmetros ou circunferências. Vamos nos concentrar em apenas três colunas para começar: peso em kg (`wgt`), altura em cm (`hgt`) e `sex` (1 indica masculino, 0 indica feminino).

Como homens e mulheres tendem a ter dimensões corporais diferentes, será útil criar dois conjuntos de dados adicionais: um só com homens e outro só com mulheres.


```{r}
mdims = bdims %>%
  subset(sex == 1)

fdims = bdims %>%
  subset(sex == 0)
```


> Exercício 1: Faça um histograma das alturas dos homens e um histograma das alturas das mulheres. Depois de plotar cada histograma, também pode ser útil construir os histogramas no mesmo gráfico/eixos. Boxplots para cada gênero também podem ser úteis. Depois de examinar os gráficos, como você compararia os vários aspectos das duas distribuições?


Vamos primeiro fazer os histogramas no mesmo eixo. Em seguida, faremos também os boxplots, a fim de subsidiar as comparações entre as duas distribuições.


```{r}
bdims = mutate(
  bdims,
  sex = ifelse(sex == 1, "m", "f")
)

bdims %>%
  ggplot(aes(x = hgt, fill = sex)) + 
  geom_histogram(alpha = 0.8, bins = 20) + 
  labs(
    title = "Alturas de homes e mulheres",
    x = "Altura (cm)",
    y = "Densidade"
  ) + 
  theme(text = element_text(size = 18)) + 
  scale_fill_manual(values = c("skyblue", "orange"))

bdims %>%
  ggplot(aes(y = hgt, fill = sex)) + 
  geom_boxplot(size = 0.6) + 
  scale_fill_manual(values = c("skyblue", "orange")) +
  theme_void() + 
  theme(text = element_text(size = 18))
```


Com base nos gráficos construídos e nos box plots, concluímos que os dois grupos possuem médias diferentes e distribuição aproximadamente normal.


## Distribuição normal


Em sua descrição das distribuições, você usou palavras como `forma de sino` ou `normal`? É tentador dizer isso quando nos deparamos com uma distribuição simétrica unimodal.

Para ver a precisão dessa descrição, podemos plotar uma curva de distribuição normal no topo de um histograma para ver o quanto os dados seguem uma distribuição normal.

A curva normal sobreposta deve ter a mesma média e desvio padrão dos dados. Estaremos trabalhando com as alturas das mulheres, então vamos armazená-las como um objeto separado e depois calcular algumas estatísticas que serão usadas/referenciadas posteriormente.


```{r}
fhgtmean = mean(fdims$hgt)
fhgtsd  = sd(fdims$hgt)
```


```{r}
fdims %>%
  ggplot(aes(x = hgt)) + 
  geom_histogram(aes(y = ..density..), alpha = 0.8, fill = "skyblue", bins = 20) + 
  geom_function(fun = dnorm, args = list(mean = fhgtmean, sd = fhgtsd), col = "red", linewidth = 1) + 
  theme(text = element_text(size = 18))
```

